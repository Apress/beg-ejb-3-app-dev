<?xml version="1.0" encoding="windows-1252" ?>
<!--Ant buildfile generated by Oracle JDeveloper 10g-->
<!--Generated Jan 2, 2006 11:30:20 AM-->
<project name="HelloEJB3WS" default="all" basedir=".">
  <property file="wsbuild.properties"/>

  <path id="classpath">
    <pathelement location="${glassfish_home}/lib/javaee.jar"/>
  </path>

  <target name="init">
    <tstamp/>
    <mkdir dir="${output.dir}"/>
  </target>
  
  <target name="all" description="Build the project" depends="compile"/>
  
  <target name="clean" description="Clean the project">
    <delete includeemptydirs="true" quiet="true">
      <fileset dir="${output.dir}" includes="**/*"/>
    </delete>
  </target>
  
  
  <target name="compile" description="Compile Java source files" depends="init">
  <echo message="Classpath  = ${glassfish_home}/lib/javaee.jar" > </echo>
  
    <javac srcdir="src" destdir="${output.dir}" classpathref="classpath"
           debug="${javac.debug}" nowarn="${javac.nowarn}"
           deprecation="${javac.deprecation}" encoding="Cp1252" source="1.5"
           target="1.5" includes="org/hello/endpoint/**"  excludes="org/hello/client/**" >
      
    </javac>
  </target>
  
  
  <target name="assemble-ejb" depends="init,compile">
    <mkdir dir="${assemble.dir}"/>
    <jar jarfile="${assemble.dir}/${appname}.jar" update="true">
      <fileset dir="${output.dir}" casesensitive="yes">
        <include name="**/*class*"/>
      </fileset>
  </jar>
    <echo message="created ejb jar  file ${assemble.dir}/${appname}.jar"
          level="verbose"></echo>
  </target>
  
    <target name="deploy-ejb" depends="init,compile,assemble-ejb" unless="ee">
    <echo message="Deploying ${assemble.dir}/${appname}.jar from ${assemble.dir}."
          level="verbose"></echo>
    <echo message="asadmin.bat deploy --user ${admin.user} --password ${admin.password} --host ${admin.host} --port ${admin.port} --upload=true --target ${appserver.instance} ${assemble.dir}/${appname}.jar"></echo>
    <exec executable="${glassfish_home}/bin/${ASADMIN}" failonerror="false">
      <arg line=" deploy"/>
      <arg line="--user ${admin.user}"/>
      <arg line="--password ${admin.password}"/>
      <arg line="--host ${admin.host}"/>
      <arg line="--port ${admin.port}"/>
      <arg line="--upload=true"/>
      <arg line="--target ${appserver.instance}"/>
      <arg line="${assemble.dir}/${appname}.jar"/>
    </exec>
  </target>

 <target name="clientproxy" depends="init">
    <mkdir dir="${output.dir}/client"/>
    <echo message="WSDL location  = http://${admin.host}:${http.port}/CreditService/CreditCheckEndpointBean?WSDL}"></echo>
    <echo message="${glassfish_home}/bin/${WSIMPORT} -keep -d ${output.dir}/client http://${admin.host}:${http.port}/CreditService/CreditCheckEndpointBean?WSDL"></echo>
    <exec executable="${glassfish_home}/bin/${WSIMPORT}" failonerror="true">
      <arg line="-keep -d ${output.dir}/client http://${admin.host}:${http.port}/CreditService/CreditCheckEndpointBean?WSDL"/>
    </exec>
  </target>
  
    <target name="compileclient"
          depends="init,clientproxy">
    <javac srcdir="src" destdir="${output.dir}/client"
           classpath="${glassfish_home}/lib/javaee.jar;${glassfish_home}/lib/appserv-ws.jar;${output.dir}/client"
           includes="org/hello/client/**"/>
  </target>
  
  
    <target name="runclient" depends="init,clientproxy,compileclient">
    <echo message="Executing client class as HelloWorldWSClient using ${glassfish_home}/bin/${APPCLIENT} "></echo>
    <exec executable="${glassfish_home}/bin/${APPCLIENT}" dir="${output.dir}/client">
      <arg value="org.hello.client.HelloWorldWSClient"/>
    </exec>
  </target>

</project>
